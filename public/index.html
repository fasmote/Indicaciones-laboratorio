<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Indicaciones - Laboratorio</title>
    <meta name="description" content="Sistema de generaci√≥n autom√°tica de indicaciones de laboratorio">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <!-- ============================================ -->
    <!-- HEADER -->
    <!-- ============================================ -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="header-title">
                    <span class="icon">üß™</span>
                    Simulador de Indicaciones de Laboratorio
                </h1>
                <p class="header-subtitle">
                    Sistema inteligente de generaci√≥n de indicaciones para pacientes
                </p>
            </div>
        </div>
    </header>

    <!-- ============================================ -->
    <!-- MAIN CONTENT -->
    <!-- ============================================ -->
    <main class="main">
        <div class="container">

            <!-- ============================================ -->
            <!-- BUSCADOR DE PR√ÅCTICAS -->
            <!-- ============================================ -->
            <section class="card search-section">
                <h2 class="section-title">
                    üîç Buscar Pr√°cticas
                </h2>

                <div class="search-box">
                    <input
                        type="text"
                        id="searchInput"
                        class="search-input"
                        placeholder="Buscar pr√°cticas por nombre (ej: GLUCOSA, HEMOGRAMA, etc.)"
                        autocomplete="off"
                    >
                    <button id="searchButton" class="btn btn-search">
                        <span class="btn-icon">üîç</span>
                        Buscar
                    </button>
                </div>

                <!-- Filtros -->
                <div class="filters">
                    <label class="filter-label">
                        <span>Filtrar por √°rea:</span>
                        <select id="areaFilter" class="filter-select">
                            <option value="">Todas las √°reas</option>
                            <option value="QUIMICA">Qu√≠mica</option>
                            <option value="HEMATO/HEMOSTASIA">Hematolog√≠a</option>
                            <option value="BACTERIO">Bacteriolog√≠a</option>
                            <option value="VIROLOGIA">Virolog√≠a</option>
                            <option value="ENDOCRINO">Endocrinolog√≠a</option>
                            <option value="INMUNOLOGIA">Inmunolog√≠a</option>
                            <option value="PARASITO">Parasitolog√≠a</option>
                            <option value="URGENCIAS Y LIQUIDOS">Urgencias</option>
                            <option value="GENETICA">Gen√©tica</option>
                            <option value="MICO">Micolog√≠a</option>
                        </select>
                    </label>
                </div>

                <!-- Resultados de b√∫squeda -->
                <div id="searchResults" class="search-results hidden"></div>

                <!-- Loading indicator -->
                <div id="searchLoading" class="loading hidden">
                    <div class="spinner"></div>
                    <span>Buscando pr√°cticas...</span>
                </div>
            </section>

            <!-- ============================================ -->
            <!-- PR√ÅCTICAS SELECCIONADAS -->
            <!-- ============================================ -->
            <section class="card selected-section">
                <h2 class="section-title">
                    ‚úÖ Pr√°cticas Seleccionadas
                    <span id="selectedCount" class="count-badge">0</span>
                </h2>

                <div id="selectedPracticas" class="selected-list">
                    <div class="empty-state">
                        <span class="empty-icon">üìã</span>
                        <p>No hay pr√°cticas seleccionadas</p>
                        <small>Busca y selecciona pr√°cticas de laboratorio para generar indicaciones</small>
                    </div>
                </div>

                <!-- Botones de acci√≥n -->
                <div id="actionButtons" class="action-buttons hidden">
                    <button id="clearButton" class="btn btn-secondary">
                        <span class="btn-icon">üóëÔ∏è</span>
                        Limpiar Todo
                    </button>
                    <button id="generateButton" class="btn btn-primary">
                        <span class="btn-icon">‚ú®</span>
                        Generar Indicaciones
                    </button>
                </div>
            </section>

            <!-- ============================================ -->
            <!-- INDICACIONES GENERADAS -->
            <!-- ============================================ -->
            <section id="resultSection" class="card result-section hidden">
                <h2 class="section-title">
                    üìÑ Indicaciones para el Paciente
                </h2>

                <!-- Loading indicator -->
                <div id="generateLoading" class="loading hidden">
                    <div class="spinner"></div>
                    <span>Generando indicaciones...</span>
                </div>

                <!-- Resultado exitoso -->
                <div id="resultSuccess" class="result-content hidden">
                    <!-- Resumen -->
                    <div class="result-summary">
                        <div class="summary-item">
                            <span class="summary-label">Pr√°cticas:</span>
                            <span id="summaryPracticas" class="summary-value">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Grupos:</span>
                            <span id="summaryGrupos" class="summary-value">0</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Indicaciones:</span>
                            <span id="summaryIndicaciones" class="summary-value">0</span>
                        </div>
                        <div class="summary-item" id="summaryAyunoContainer">
                            <span class="summary-label">‚è∞ Ayuno:</span>
                            <span id="summaryAyuno" class="summary-value ayuno-highlight">-</span>
                        </div>
                    </div>

                    <!-- Texto de indicaciones -->
                    <div class="result-text">
                        <div id="indicacionesText" class="indicaciones-text"></div>
                    </div>

                    <!-- Botones de acci√≥n -->
                    <div class="result-actions">
                        <button id="copyButton" class="btn btn-secondary">
                            <span class="btn-icon">üìã</span>
                            Copiar al Portapapeles
                        </button>
                        <button id="printButton" class="btn btn-secondary">
                            <span class="btn-icon">üñ®Ô∏è</span>
                            Imprimir
                        </button>
                        <button id="newButton" class="btn btn-primary">
                            <span class="btn-icon">‚ûï</span>
                            Nueva Consulta
                        </button>
                    </div>
                </div>

                <!-- Resultado con error -->
                <div id="resultError" class="result-error hidden">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <h3 class="error-title">Error al generar indicaciones</h3>
                    <p id="errorMessage" class="error-message"></p>
                    <button id="retryButton" class="btn btn-primary">
                        <span class="btn-icon">üîÑ</span>
                        Reintentar
                    </button>
                </div>
            </section>

            <!-- ============================================ -->
            <!-- INFORMACI√ìN DEL SISTEMA -->
            <!-- ============================================ -->
            <section class="card info-section">
                <h2 class="section-title">‚ÑπÔ∏è Informaci√≥n del Sistema</h2>
                <div class="info-content">
                    <div class="info-item">
                        <strong>Pr√°cticas disponibles:</strong>
                        <span id="totalPracticas" class="info-value">Cargando...</span>
                    </div>
                    <div class="info-item">
                        <strong>Estado del servidor:</strong>
                        <span id="serverStatus" class="info-value status-checking">Verificando...</span>
                    </div>
                    <div class="info-item">
                        <strong>Versi√≥n:</strong>
                        <span class="info-value">1.3.0</span>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- ============================================ -->
    <!-- FOOTER -->
    <!-- ============================================ -->
    <footer class="footer">
        <div class="container">
            <p class="footer-text">
                Sistema de Indicaciones de Laboratorio v1.3.0
                <br>
                <small>Desarrollado con Node.js + Express + Prisma + SQLite</small>
            </p>
        </div>
    </footer>

    <!-- ============================================ -->
    <!-- TOAST NOTIFICATIONS -->
    <!-- ============================================ -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- ============================================ -->
    <!-- SCRIPTS -->
    <!-- ============================================ -->
    <script src="/js/api.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/simulador.js"></script>
</body>
</html>
